PROJECT(simulator)

CMAKE_MINIMUM_REQUIRED(VERSION 2.8.6)

IF(COMMAND cmake_policy)
	CMAKE_POLICY(SET CMP0003 NEW)
ENDIF(COMMAND cmake_policy)


SET(SIMULATOR_PROJECT_DIR "${CMAKE_HOME_DIRECTORY}/..")
SET(SG_ROOT_DIR "${SIMULATOR_PROJECT_DIR}/../..")

INCLUDE(${SG_ROOT_DIR}/build/cmake/Common.cmake)
INCLUDE(${SG_ROOT_DIR}/build/cmake/Platform.cmake)

SET(SG_BIN_DIR "${SG_ROOT_DIR}/bin/${SG_PLATFORM_NAME}")

INCLUDE(${SG_ROOT_DIR}/build/cmake/Compiler.cmake)

SET_PROPERTY(GLOBAL PROPERTY USE_FOLDERS ON)

SET(SIMULATOR_OUTPUT_DIR "${SIMULATOR_PROJECT_DIR}/lib/${SG_PLATFORM_NAME}")
SET(SIMULATOR_BIN_DIR "${SIMULATOR_PROJECT_DIR}/bin/${SG_PLATFORM_NAME}")

# The project settings

SET(EXE_NAME simulator)

SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/simulator.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/qcom_simulator.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/line_reader.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/action.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/qcom_action.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/action_factory.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/qcom_action_factory.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/action_center.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/predeclare.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/utils.hpp)
SET(SIMULATOR_HEADER_FILES ${SIMULATOR_HEADER_FILES} ${SG_ROOT_DIR}/include/simulator/cmd_parser.hpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/main.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/simulator.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/qcom_simulator.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/line_reader.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/action.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/qcom_action.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/action_factory.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/qcom_action_factory.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/action_center.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/utils.cpp)
SET(SIMULATOR_SOURCE_FILES ${SIMULATOR_SOURCE_FILES} ${SG_ROOT_DIR}/src/simulator/cmd_parser.cpp)

SOURCE_GROUP("Source Files" FILES ${SIMULATOR_SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${SIMULATOR_HEADER_FILES})

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${SG_ROOT_DIR}/include)

LINK_DIRECTORIES(${Boost_LIBRARY_DIR})
LINK_DIRECTORIES(${SG_ROOT_DIR}/build/core/lib/${SG_PLATFORM_NAME})
LINK_DIRECTORIES(${SG_ROOT_DIR}/build/comms/lib/${SG_PLATFORM_NAME})

IF(UNIX)
    SET(EXTRA_LINKED_LIBRARIES ${EXTRA_LINKED_LIBRARIES}
        debug core${SG_OUTPUT_SUFFIX}_d optimized core${SG_OUTPUT_SUFFIX}
        debug comms${SG_OUTPUT_SUFFIX}_d optimized comms${SG_OUTPUT_SUFFIX}
        debug readline
        ncurses
        ${Boost_PROGRAM_OPTIONS_LIBRARY})
ENDIF()

ADD_EXECUTABLE(${EXE_NAME} ${SIMULATOR_SOURCE_FILES} ${SIMULATOR_HEADER_FILES})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY ${SIMULATOR_BIN_DIR}
    RUNTIME_OUTPUT_DIRECTORY_DEBUG ${SIMULATOR_BIN_DIR}
    RUNTIME_OUTPUT_DIRECTORY_RELEASE ${SIMULATOR_BIN_DIR}
    PROJECT_LABEL ${EXE_NAME}
    DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
    OUT_PUTNAME ${EXE_NAME}${SG_OUTPUT_SUFFIX}
)

TARGET_LINK_LIBRARIES(${EXE_NAME} ${EXTRA_LINKED_LIBRARIES})

ADD_POST_BUILD(${EXE_NAME} "")

INSTALL(TARGETS ${EXE_NAME}
    RUNTIME DESTINATION ${SG_BIN_DIR}
    LIBRARY DESTINATION ${SG_BIN_DIR}
    ARCHIVE DESTINATION ${SIMULATOR_OUTPUT_DIR}
)


